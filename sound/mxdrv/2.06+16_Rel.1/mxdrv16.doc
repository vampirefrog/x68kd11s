
	「mxdrv 2.06+16 Rel.1 (mxdrv16.x) 簡易説明書」

							original copyright 1988 milk
				extend copyright 1988-91 K.MAEKAWA, Yatsube, Missy.M

							written by Missy.M 1991/11/06

［最初に］

いやーーーー、前回のサンプル版からいつのまにか二ヶ月もたっていたんですねぇ．．．．

江藤氏のＰＣＭ８．Ｘが、やっと一息ついたみたいですので、こっちも、一息つくというか、

一ヶ月程使っていて、非常に安定しているようなので、このバージョンを＋１６正式版として、

公開します。



［従来との変更点］

＊前回のサンプル版では、ＰＣＭ８が組み込まれていると、従来ＭＤＸのＰＣＭチャンネルが

　キーオフしないでどんどん重なりましたが、このモードを廃止しました。

　元々、ＰＣＭ８の威力を試すために設けられたものですが、既にＰＣＭ８の威力を

　殆どの人が知っていると思われますので、従来との互換という点で、廃止しました。

　キーオフしたつもりがされていないというのは、やはり問題があるので．．．．．

　最新のＰＣＭ８では、ＰＣＭ８自体でその設定ができるようになってしまいましたが．．（笑）


＊ＭＭＬ中にフェードアウトが記述できます。

　が、現在、対応しているＭＭＬコンバーターがありません。

　コマンドフォーマットは、「$E7,$01,SPEED」です。

　OPT1+XF3で、スピード設定が付いたような動作になります。


＊ＭＤＸ中の未使用コマンドの動作を、「演奏終了」にしました。

　新バージョン用のＭＤＸを旧ドライバで演奏した場合、ハチマキが出ることに

　なってしまいましたので、将来において同じようなことが起きないように

　「演奏中に未使用コマンドが検出されたチャンネルは、その時点で演奏終了」

　するようになっています。


＊新ＰＣＭ８に対応するために若干の変更

　新ＰＣＭ８で、ＯＰＭレジスタをアクセスする必要が発生し、

　アクセスがぶつかってケンカすることが考えられるため、

　新ＰＣＭ８とはぶつからないように細工しました。

　そのため、若干処理が重くなっています。

　ＰＣＭ８以外でぶつからない保証は全然ありません。（笑）

　が、恐らく大丈夫でしょう。今までも、ＣＴ１／ＣＴ２が外部からアクセスされても

　なんともない構造になってましたし。

　（他のＦＭ音源ドライバとぶつかったら、さすがにケンカするでしょうが．．．）


＊今回より、リリース番号を付加しました。

　バグ、細かい仕様変更などで、「拡張バージョン自体は変更無いが、バージョンアップしている」

　という場合など、リリース番号を更新することにしました。

（＋１５シリーズが物凄い沢山バージョンあって、作った本人自体混乱したので）

　内部的に仕様追加などがあった場合は、従来どうり、拡張バージョンの更新となります。

　また、今のところ、リリース番号をアプリケーションで取得する方法はありません。

　必要ありませんよねぇ？．．．．．．




［使用方法］

従来どうり、「mxdrv16」と、スイッチを付けずに入力して頂くだけで結構です。

拡張モードの選択は、演奏するデーターで行ないます。

また、「-p」「-m」などのスイッチも従来どうり使用できます。

拡張されたスイッチなどはありません。

	-p数値 または -p:数値		ＰＤＸバッファデーターサイズを指定します。
					デフォルトは312キロです。

	-m数値 または -m:数値		ＭＤＸバッファデータサイズを指定します。
					デフォルトは64キロです。

	-f数値 または -f:数値		キーボードコントロールによるフェードアウトの
					スピードを設定します。
					デフォルトは23です。



［演奏方法］

ＭＸＰ及び互換ツールにて、ＭＤＸファイル、ＰＤＸファイルを使用することにより

演奏させることができます。

演奏指令に関する拡張はありません。

従来のＭＸＰなどがそのまま使用可能です。


＊拡張モード時に、チャンネル指定して演奏させる場合は、チャンネル指定する

　ツールを拡張する必要があります。（Ｑ〜Ｗが指定できません）

　前回、割愛させて頂いたので、今回は、ＭＸＰを添付しました。

　-pオプションの拡張の他、mdx-makerの為に「PDX強制読み込みオプション」が

　追加されています。こっちの方はてきとーに改造したので、不都合などがあるかも

　しれませんが、どうか御了承下さい。

　現在、プレイヤーの仕様変更を検討していますので、０からＭＸＰを作るでしょうし。




［拡張モードへの移行方法］

ドライバに対して、拡張モードのＯＮ／ＯＦＦを外部からコントロールすることはできません。

拡張モード用のＭＤＸには、拡張モード識別用のデータが埋め込まれており、

このデータを確認して初めて、拡張モードに移行します。

従来のＭＤＸで拡張モードに移行することはありませんし、させることもできません。

また、この、拡張モード識別用のデーターを検出した時に、ＰＣＭ４叉は

ＰＣＭ８が組み込まれていないと、拡張モードへは移行しません。あしからず。



［ＰＣＭチャンネルの動作について］．．．．以下の点に注意して下さい。


＊拡張モードへの移行は曲の最初

　　拡張モード用に作ったＭＤＸでも、ＰＣＭ４／８が組み込まれていないと、

　　従来と同じようにＰチャンネルしかなりません。また、ＰＣＭ４／８が

　　組み込まれていないので、キーオフされないこともありません。

　　拡張モードへの移行をするかどうかは曲の最初にチェックされますので、

　　その時にＰＣＭ４／８が組み込まれていないと、上と同じ悲惨な状態になります。


＊やたらにＰＣＭのパンを振るな

　　ＰＣＭ４／８を使用すると、とにかくＰＣＭが重なります。

　　違う周波数同士もちゃんとＭＩＸされて出力されるのですが、

　　ハードにはＰＡＮが一個しかありません。

　　つまり、「周波数は好き勝手にやってなんともないが、ＰＡＮはもろ影響を受ける」

　　ということです。これは、ハードの問題でもあり、ＰＣＭ４／８の仕様でもあるので、

　　ＰＣＭ４／８が組み込まれていれば、従来モード拡張モード問わず、

　　最後に出力した音のＰＡＮが有効になります。

　　また、凄い速さでＰＡＮを切り替えるとぷちぷちが鳴ることがありますので、

　　注意して下さい。（他の音がキーオフされていないのにＰＡＮを切り替えるため）




［拡張モードについて］

　　この文章では、あちこちで「拡張モード」という言葉を使用していますが、

　　この、拡張モードについて説明します。


　　まず、拡張モードだと．．．．．


＊Ｐチャンネルだけでなく、ＱＲＳＴＵＶＷチャンネルもＭＭＬでＰチャンネル同様の

　ＭＭＬが書け、演奏できます。（ＰＣＭ８組み込み時。ＰＣＭ４の場合はＴＵＶＷチャンネルが

　あっても無視されます。）


＊６４キロ超のデーターを再生できる。

　従来は、ＰＣＭの１データーの長さは６４キロまででしたが、

　この制限が無くなります。しかし、標準のＰＤＸＭが６４キロ以上に対応していないので、

　ＴＰＤＸＭなどを使用することをお勧めします。


＊９６個制限も無くなる。

　従来は、ＰＤＸには９６個までしか登録できませんでしたが、この制限も無くなります。

　といっても、キーコードが０〜９５しかないので、＠コマンドでバンク切り替えが可能に

　なっています。（デフォルト＠０。＠１で９６〜１９１番を選択することになる）

　＠コマンドの上限値は、今のところ制限していないので２５５になっています。


　　んでもって、拡張モード（ＰＣＭ８組み込み）だからおきる問題。


＊上でも書きましたが、ＰＡＮは一個しかありません。

　が、各チャンネル毎に管理して、各チャンネル毎に出力しています。

　つまり、各チャンネル間でＰＡＮが統一されていないと、つねにＰＡＮが切り変わることに

　なりますので、ぷちぷちの原因などになります。できる限り統一して下さい。


＊これも上で書きましたが、拡張モード移行は曲の演奏開始時です。

　この時にＰＣＭ４／８の組み込みチェックを行ない、使用できないようなら

　従来モードになります。

　また、曲の最初でしかチェックしないので、拡張モードＭＤＸを

　ＰＣＭ４／８組込み忘れて従来モードになった場合、演奏中にＰＣＭ４／８を組み込んでも

　拡張モードには移行しません。再演奏させる必要があります。


＊＠コマンドで、存在しないバンク番号を指定すると、音が鳴らないか変な音がするかの

　どちらかになります。つまり、登録数が可変になっているせいで、ヘッダも大きさが

　可変になっていますので、実際にヘッダでない場所をヘッダとしてアクセスすると、

　動作は不定になります。飛ぶことはないようにしていますが．．．．






［最後に］

本来なら、ここで、「フリーウェア宣言」「無保証だよん」などの文章が

書かれるのですが、割愛させて頂きます。


バグなど見つけた場合は連絡お願いします。








＊改造ＭＸＰについて。

当方で使用していた改造ＭＸＰを更に改造したものです。

何が違うかというと．．．．．

「−Ｐオプションで、Ｑ〜Ｗチャンネルが指定できる」

「−Ｌオプションを付けると、ＰＤＸファイルが必要な場合に必ず読み込む」

程度でしょうか．．．．．

−Ｌオプションについては、−Ｐオプションの機能も兼ねてますので、

演奏チャンネルを指定することも可能です。

mxp -LPQRSTUVW NANINANI[.mdx] DOUSITA[.pdx]　というように．．．．














北海道は初雪だよーん。あーさむさむ。

この靴気に入ってたんだけど、さすがに雪降ったら履けないなぁ．．．．滑るから．．．．

という分けで、最近、ＭＸＤＲＶという枠で可能なことがだんだん少なくなってきたというか、

そのような感じがします。

元々、シンプルなドライバなので、あまり複雑な仕様は追加したくないというのがあり、

殆どバージョンアップが止まっているという話もあります。（別なもの作っているという話もある）

が、今の技術レベルのドライバを０から作るとなると、半年はかかるので、

こっちも、構想だけで、実際手を付けてません。

出来たら出来たで、とんでもないものができるのはわかっているんですが．．．．

６８０００の１０ＭＨｚでは、処理が重すぎるようなことになる恐れもありますけど。（笑）


今の現状を見る限り、Ｘ６８Ｋは、１０ＭＨｚユーザーがほとんどですし、

６８０００の１０ＭＨｚでは、ＰＣＭ８が限度だと思います。速度的に。

実際、ＣＰＵパワーをほとんど持ってかれますからねぇ．．．．．

既に、処理速度だけで見た場合、音源ドライバとして許される範囲を遥かに越えています。

これ以上重装備にしても、ほとんどのＸ６８Ｋユーザーは使えないような．．．．．

やはり、多少メモリは消費しても、１０ＭＨｚで動くものでないと、

ちょっと悲しいものがありますし。


あ、今、ＭＸＤＲＶとＰＣＭ８組み込んだ状態で空きメモリが１Ｍ程度無い人は、

システムを再設計するか、メモリを増設することをお勧めします。

決して強制する分けではありませんが、＋１７は動かないかも．．．．．知れません。

ちょっと豪快な仕様になるので．．．．．＋１７は．．．．．

ＡＤＰＣＭという方法自体、普通のＰＣＭから比べれば容量食わない筈なのに．．．．．

ということは、これを普通の１６ビットＰＣＭでやった場合、

全部でメモリが８Ｍ位いるのかぁ．．．．ひょひょーーーーー

ＴＯＷＮＳだと絶対こんなことできないし、許されないわ。

まだ、ＣＤとか、周波数ずらしとか、色々な方法があるけど。


ＰＣＭ８の出現で、ＭＸＤＲＶの世界に変化が起こりましたが、

まだ、この変化は終わっていません。もう少し変化するでしょう。恐らく。

一部では、１ＭのＰＤＸが既に存在するという．．．．話だし．．．．ひょーーーー

